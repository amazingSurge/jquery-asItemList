/**
* jQuery asItemList v0.2.0
* https://github.com/amazingSurge/jquery-asItemList
*
* Copyright (c) amazingSurge
* Released under the LGPL-3.0 license
*/
!function(t,e){if("function"==typeof define&&define.amd)define(["jquery","Sortable"],e);else if("undefined"!=typeof exports)e(require("jquery"),require("Sortable"));else{var i={exports:{}};e(t.jQuery,t.Sortable),t.jqueryAsItemListEs=i.exports}}(this,function(t,e){"use strict";function i(t){return t&&t.__esModule?t:{default:t}}function s(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}var a=i(t),n=i(e),l="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},r=function(){function t(t,e){for(var i=0;i<e.length;i++){var s=e[i];s.enumerable=s.enumerable||!1,s.configurable=!0,"value"in s&&(s.writable=!0),Object.defineProperty(t,s.key,s)}}return function(e,i,s){return i&&t(e.prototype,i),s&&t(e,s),e}}(),o={namespace:"asItemList",sortableID:"asItemList-sortable",leng:"en",itemList:function(){return'<div class="namespace-container"><a class="namespace-addItem"><i></i>{{strings.addTitle}}</a><ul class="namespace-list"></ul><div class="namespace-prompt">{{strings.prompt}}</div></div>'},render:function(t){return t},process:function(t){if(t){var e=JSON.stringify(t);return"[]"===e?"":e}return""},parse:function(t){return t?$.parseJSON(t):null},onInit:null,onReady:null,onAdd:null,onEdit:null,onAfterFill:null},u="asItemList",h={},d=function(){function t(e,i){s(this,t),this.element=e,this.$element=(0,a.default)(e),this.options=a.default.extend({},o,i,this.$element.data()),"undefined"==typeof h[this.options.lang]?this.lang="en":this.lang=this.options.lang,this.strings=a.default.extend({},h[this.lang],this.options.strings),this.namespace=this.options.namespace,this.classes={disabled:this.namespace+"_disabled",wrapper:this.namespace+"-wrapper",active:this.namespace+"_active",empty:this.namespace+"_empty",hide:this.namespace+"_hide",hover:this.namespace+"_hover"},this.$element.addClass(this.namespace),this.$element.wrap('<div class="'+this.classes.wrapper+'"></div>'),this.$wrapper=this.$element.parent(),this.$itemList=(0,a.default)(this.options.itemList().replace(/namespace/g,this.namespace).replace(/\{\{strings.addTitle\}\}/g,this.strings.addTitle).replace(/\{\{strings.prompt\}\}/g,this.strings.prompt)),this.$addItem=this.$itemList.find("."+this.namespace+"-addItem"),this.$prompt=this.$itemList.find("."+this.namespace+"-prompt"),this.$list=this.$itemList.find("."+this.namespace+"-list"),this.$list.attr("id",this.options.sortableID),this.disabled=!1,this.initialized=!1,this._trigger("init"),this.init()}return r(t,[{key:"init",value:function(){var t=this;this.$element.hide(),this.$element.before(this.$itemList),this.value=this.options.parse(this.$element.val()),this.set(this.value,!1),this.$addItem.on("click",function(){t._trigger("add")});var e=document.getElementById(this.options.sortableID);this.$list.on("click","li",a.default.proxy(function(t){this.editIndex=(0,a.default)(t.currentTarget).index(),this._trigger("edit",this.editIndex)},this)).on("mouseenter","li",a.default.proxy(function(t){(0,a.default)(t.currentTarget).addClass(this.classes.hover)},this)).on("mouseleave","li",a.default.proxy(function(t){(0,a.default)(t.currentTarget).removeClass(this.classes.hover)},this)).on("mouseenter","."+this.namespace+"-list-drag",a.default.proxy(function(i){this.sortIndex=(0,a.default)(i.currentTarget).parent().index(),this.sort=new n.default(e,{onUpdate:function(e){var i=t.value.splice(t.sortIndex,1);t.value.splice((0,a.default)(e.item).index(),0,i[0]),t.$element.val(t.options.process(t.value))}})},this)).on("mouseleave","."+this.namespace+"-list-drag",a.default.proxy(function(){},this)).on("click","."+this.namespace+"-list-remove",a.default.proxy(function(t){return this.indexed=(0,a.default)(t.currentTarget).parent().index(),this.remove(this.indexed),!1},this))}},{key:"_update",value:function(){this.$element.val(this.val()),this._trigger("change",[this.value])}},{key:"_updateList",value:function(){if(this.value.length>this.$list.children().length)this._addList();else if(this.value.length===this.$list.children().length&&0!==this.value.length){var t=this.value[this.editIndex];this.$list.children().eq(this.editIndex).html(this._editList(t))}else 0===this.value.length&&this.$wrapper.addClass(this.classes.empty),this._delList()}},{key:"_editList",value:function(t){return'<span class="'+this.namespace+'-list-drag"></span><div class="'+this.namespace+'-list-item">'+this.options.render(t)+'</div><a href="#" class="'+this.namespace+'-list-remove"></a>'}},{key:"_addList",value:function(){this.$wrapper.removeClass(this.classes.empty);for(var t,e=this.$list.children().length;e<this.value.length;e++)t=this.value[e],(0,a.default)("<li/>",{html:this._editList(t)}).appendTo(this.$list)}},{key:"_delList",value:function(){this.$list.children().eq(this.indexed).remove()}},{key:"_clearList",value:function(){this.$list.children().remove()}},{key:"_trigger",value:function(t){for(var e,i=arguments.length,s=Array(i>1?i-1:0),a=1;a<i;a++)s[a-1]=arguments[a];var n=(e=[this]).concat.apply(e,s);this.$element.trigger(u+"::"+t,n),t=t.replace(/\b\w+\b/g,function(t){return t.substring(0,1).toUpperCase()+t.substring(1)});var l="on"+t;if("function"==typeof this.options[l]){var r;(r=this.options[l]).apply.apply(r,[this].concat(s))}}},{key:"val",value:function(t){if("undefined"==typeof t)return this.options.process(this.value);var e=this.options.parse(t);e?this.set(e):this.clear()}},{key:"set",value:function(t,e){a.default.isArray(t)?this.value=t:this.value=[],this._clearList(),this._updateList(),e!==!1&&this._update()}},{key:"clear",value:function(t){this.value=[],this._clearList(),this.$wrapper.addClass(this.classes.empty),t!==!1&&this._update()}},{key:"remove",value:function(t,e){this.value.splice(t,1),this._updateList(),e!==!1&&this._update()}},{key:"add",value:function(t,e){for(var i in t)({}).hasOwnProperty.call(t,i)&&this.value.push(t[i]);this._updateList(),e!==!1&&this._update()}},{key:"update",value:function(t,e,i){this.value[t]=e,this._updateList(),i!==!1&&this._update()}},{key:"get",value:function(){return this.value}},{key:"enable",value:function(){this.disabled=!1,this.$wrapper.removeClass(this.classes.disabled),this._trigger("enable")}},{key:"disable",value:function(){this.disabled=!0,this.$wrapper.addClass(this.classes.disabled),this._trigger("disable")}},{key:"destory",value:function(){this.$element.data(u,null),this._trigger("destory")}}],[{key:"localize",value:function(t,e){h[t]=e}},{key:"setDefaults",value:function(t){a.default.extend(o,a.default.isPlainObject(t)&&t)}}]),t}();d.localize("en",{addTitle:"Add new list",prompt:"There is no item"});var c={version:"0.2.0"},p="asItemList",f=a.default.fn.asItemList,v=function(t){for(var e=this,i=arguments.length,s=Array(i>1?i-1:0),n=1;n<i;n++)s[n-1]=arguments[n];if("string"==typeof t){var r=function(){var i=t;if(/^_/.test(i))return{v:!1};if(!/^(get|val)/.test(i))return{v:e.each(function(){var t=a.default.data(this,p);t&&"function"==typeof t[i]&&t[i].apply(t,s)})};var n=e.first().data(p);return n&&"function"==typeof n[i]?{v:n[i].apply(n,s)}:void 0}();if("object"===("undefined"==typeof r?"undefined":l(r)))return r.v}return this.each(function(){(0,a.default)(this).data(p)||(0,a.default)(this).data(p,new d(this,t))})};a.default.fn.asItemList=v,a.default.asItemList=a.default.extend({setDefaults:d.setDefaults,noConflict:function(){return a.default.fn.asItemList=f,v}},c)});